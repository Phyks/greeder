{loop="$events"}
	{$plainDescription=strip_tags($value->getDescription())}

    {function="Plugin::callHook("event_pre_section", array(&$value))"}
    <article class="feedArticle
        {if="!$value->getUnread()"} eventRead {/if} {* Already read *}
        {if="isset($articleDisplayContent) && $articleDisplayContent === false"} digest {/if} {* just the title *}
        {if="$value->getFavorite() == 1"} favorised {/if} {* this is a favorite *}
    	{if="$scroll"} scroll{/if}"
    	>
		<a class="anchor" id="{$value->getId()}"></a>

		<!-- Buttons -->
		<nav class="articles-button-bar {if="$myUser==false"}lecture-anonyme{/if}">
			{function="Plugin::callHook("event_pre_title", array(&$value))"}
			{if="$value->getFavorite()!=1"}
				<button class="btn square favs" onclick="addFavorite(this,{$value->getId()});" >★</button>
			{else}
				<button class="btn square favs" onclick="removeFavorite(this,{$value->getId()});" >★</button>
			{/if}
			<button class="btn red read_button" onclick="readThis(this,{$value->getId()}{$action=='unreadEvents' || $action==''?',true':''});">{function="_t('READ')"}/{function="_t('UNREAD')"}</button>
		</nav>
		<h1>
			<span class="star" >★</span>
			<a onclick="readThis(this,{$value->getId()},'title');" target="_blank" href="{$value->getLink()}" title="{$plainDescription}">{$value->getTitle()}</a>
			{function="Plugin::callHook("event_post_title", array(&$value))"}
		</h1>

		<h2>
			{function="Plugin::callHook("event_pre_top_options", array(&$value))"}
			{if="$articleDisplayLink"}
				<a href="index.php?action=selectedFeed&amp;feed={$value->getFeed()}">{$allFeeds['idMap'][$value->getFeed()]['name']}</a>
			{/if}
			{if="$articleDisplayAuthor"}
				par {$value->getCreator()}
			{/if}

			{if="$articleDisplayDate"}
				{$value->getPubdateWithInstant($time)}
			{/if}

			{function="Plugin::callHook("event_post_top_options", array(&$value))"}
		</h2>

		<!-- Content -->
		{if="$articleDisplayMode=='summary'"}
			<div class="articleContent summary">
				{function="Plugin::callHook("event_pre_description", array(&$value))"}
				{$value->getDescription()}
				{function="Plugin::callHook("event_post_description", array(&$value))"}
			</div>
		{else}
			<div class="articleContent summary" style="display: none;">
			</div>
		{/if}
		{if="$articleDisplayMode=='content'"}
			<div class="articleContent content">
				{function="Plugin::callHook("event_pre_content", array(&$value))"}
				{$value->getContent()}
				{function="Plugin::callHook("event_post_content", array(&$value))"}
			</div>
		{else}
			<div class="articleContent content" style="display: none;">
			</div>
		{/if}
	
		<!-- Complete view : repeat buttons -->
		{if="$articleDisplayMode=='content'"}
			<nav class="articles-button-bar articles-button-bar-repeat {if="$myUser==false"}lecture-anonyme{/if}">
				{function="Plugin::callHook("event_pre_title", array(&$value))"}
				{if="$value->getFavorite()!=1"}
					<button class="btn square favs" onclick="addFavorite(this,{$value->getId()});" >★</button>
				{else}
					<button class="btn square favs" onclick="removeFavorite(this,{$value->getId()});" >★</button>
				{/if}
				<button class="btn red read_button" onclick="readThis(this,{$value->getId()}{$action=='unreadEvents' || $action==''?',true':''});">{function="_t('READ')"}/{function="_t('UNREAD')"}</button>
			</nav>
			<div class="clear"></div>
		{/if}

		<!-- Display more/less -->
			{if="$articleDisplayMode=='title'"}
				<a class="btnDisplayMode" onclick="toggleArticleDisplayMode(this,{$value->getId()})" title="{function="_t('EVENT_DISPLAY_TITLE')"}">+&nbsp;&nbsp;</a>
			{/if}
			{if="$articleDisplayMode=='summary'"}
				<a class="btnDisplayMode" onclick="toggleArticleDisplayMode(this,{$value->getId()})" title="{function="_t('EVENT_DISPLAY_SUMMARY')"}">++&nbsp;</a>
			{/if}
			{if="$articleDisplayMode=='content'"}
				<a class="btnDisplayMode" onclick="toggleArticleDisplayMode(this,{$value->getId()})" title="{function="_t('EVENT_DISPLAY_CONTENT')"}">-</a>
			{/if}

	</article>
{/loop}
